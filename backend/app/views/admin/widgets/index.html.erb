<h1 class="h3 mb-3 me-2 d-inline-block">Widgets</h1>

<%= render "index_search_form", q: @q, search_by: :title_or_description_cont do |f| %>
  <div class="d-inline-block" data-controller="filters">
    <button type="button" class="btn btn-primary-outline m1-n1" data-filters-target="button">
      <i class="bi bi-filter"></i>
      Filters
      <% if @q.conditions.any? %>
        <span class="badge bg-info"><%= @q.conditions.count %></span>
      <% end %>
    </button>
    <template data-filters-target="popup">
      <%= f.input :theme_id_eq, as: :select, label: 'Theme', collection: Theme.order(:title) %>

      <%= button_tag 'Apply', class: 'btn btn-primary', type: :submit %>
      <%= link_to 'Reset', admin_widgets_url, class: 'btn btn-link' %>
    </template>
  </div>
<% end %>

<table class="table table-hover" data-controller="table">
  <thead>
    <tr>
      <th>
        <%= sort_link @q, :theme_title, 'Theme' %>
      </th>
      <th>
        <%= sort_link @q, :title %>
      </th>
      <th>
        <%= sort_link @q, :description %>
      </th>
      <th>
      </th>
    </tr>
  </thead>
  <tbody>
    <% @resources.each do |widget| %>
      <tr data-link="<%= edit_admin_widget_path(widget) %>">
        <td><%= widget.theme.title %></td>
        <td><%= widget.title %></td>
        <td><%= widget.description %></td>
        <td class="d-flex justify-content-end">
          <%= dropdown "Actions" do %>
            <li>
              <%= link_to 'Edit', edit_admin_widget_path(widget), class: "dropdown-item" %>
            </li>
          <% end %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<% content_for(:content_footer) do %>
  <%== pagy_bootstrap_nav(@pagy) %>

  <div class="float-end">
    <%== pagy_info(@pagy) %>
  </div>
<% end %>
